<section class="card">
  <h3>Upload</h3>

  <label>
    Choose file
    <input type="file" (change)="onFileChange($event)">
  </label>

  <label>
    Expiration days (max 7):
    <input type="number" [(ngModel)]="expirationDays" name="expirationDays" min="1" max="7">
  </label>

  <label>
    Password (optional, min 6 chars):
    <input type="password" [(ngModel)]="password" name="password">
  </label>

  <label>
    Tags (comma separated):
    <input type="text" [(ngModel)]="tagsText" name="tags">
  </label>

  <div style="margin-top:0.6rem">
    <button (click)="upload()">Upload</button>
  </div>

  <p class="footer-note">{{ message }}</p>

  <div *ngIf="result" style="margin-top:0.8rem">
    <div class="card" style="padding:0.6rem">
      <div *ngIf="result.token">
        <strong>Lien de partage :</strong> 
        <a [href]="getDownloadUrl(result.token)" target="_blank">{{ getDownloadUrl(result.token) }}</a>
      </div>
      <div *ngIf="result.filename"><strong>File:</strong> {{ result.filename }}</div>
      <div *ngIf="result.expiresAt"><strong>Expires:</strong> {{ result.expiresAt }}</div>
    </div>
  </div>

  <div *ngIf="history && history.length > 0" style="margin-top:1.5rem">
    <h4>Upload History</h4>
    <table style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr style="border-bottom: 1px solid #ccc; text-align: left;">
          <th>Filename</th>
          <th>Date</th>
          <th>Expires</th>
          <th>Size</th>
          <th>Token</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of history" style="border-bottom: 1px solid #eee;">
          <td>{{ item.filename }}</td>
          <td>{{ item.createdAt | date:'short' }}</td>
          <td>{{ item.expiresAt | date:'short' }}</td>
          <td>{{ (item.size / 1024).toFixed(1) }} KB</td>
          <td><a [href]="getDownloadUrl(item.token)" target="_blank">Lien</a></td>
        </tr>
      </tbody>
    </table>
  </div>
</section>
